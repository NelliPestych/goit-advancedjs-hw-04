{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["// pixabay-api.js\nimport axios from 'axios';\n\nconst API_KEY = '16588925-02413834d9828552035921ade'; // Замініть на ваш реальний ключ\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport default class PixabayApi {\n  constructor() {\n    this.query = '';\n    this.page = 1;\n    this.perPage = 15; // Завантажуємо 15 зображень за запит\n  }\n\n  async fetchImages() {\n    try {\n      const response = await axios.get(BASE_URL, {\n        params: {\n          key: API_KEY,\n          q: this.query,\n          image_type: 'photo',\n          orientation: 'horizontal',\n          safesearch: true,\n          page: this.page,\n          per_page: this.perPage,\n        },\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Error fetching images:', error);\n      throw error;\n    }\n  }\n\n  resetPage() {\n    this.page = 1;\n  }\n\n  incrementPage() {\n    this.page += 1;\n  }\n\n  setQuery(newQuery) {\n    this.query = newQuery;\n  }\n}\n","/**\n * Функція для створення HTML-розмітки зображень\n * @param {Array} images - масив зображень\n * @returns {string} HTML-розмітка\n */\nexport const renderImages = (images) => {\n  return images\n    .map(\n      ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n        <a class='gallery-item' href='${largeImageURL}'>\n          <img src='${webformatURL}' alt='${tags}' loading='lazy' />\n          <div class='info'>\n            <div class='info-item'>Likes<p> ${likes}</p></div>\n            <div class='info-item'>Views<p> ${views}</p></div>\n            <div class='info-item'>Comments<p> ${comments}</p></div>\n            <div class='info-item'>Downloads<p> ${downloads}</p></div>\n          </div>\n        </a>\n      `,\n    )\n    .join('');\n};\n\n/**\n * Функція для оновлення галереї зображень\n * @param {HTMLElement} galleryContainer - DOM-елемент галереї\n * @param {string} markup - HTML-розмітка\n * @param {boolean} append - чи додавати нові елементи до галереї (true) або перезаписувати (false)\n */\nexport const updateGallery = (galleryContainer, markup, append = false) => {\n  if (!append) {\n    galleryContainer.innerHTML = markup; // Повне оновлення галереї\n  } else {\n    galleryContainer.insertAdjacentHTML('beforeend', markup); // Додати до існуючих\n  }\n};\n\n/**\n * Функція для виводу повідомлень\n * @param {string} message - Текст повідомлення\n * @param {HTMLElement} container - DOM-елемент, де показати повідомлення\n */\nexport const showMessage = (message, container) => {\n  container.innerHTML = `<p class='message'>${message}</p>`;\n};","import PixabayApi from \"./js/pixabay-api.js\";\nimport { renderImages, updateGallery, showMessage } from \"./js/render-functions.js\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst searchForm = document.querySelector(\"#search-form\");\nconst galleryContainer = document.querySelector(\".gallery\");\nconst loadMoreBtn = document.querySelector(\".load-more\");\nconst messageContainer = document.querySelector(\".message-container\");\nconst loader = document.querySelector(\".loader\");\n\nconst pixabayApi = new PixabayApi();\nconst lightbox = new SimpleLightbox(\".gallery a\");\n\n// Показати завантажувач\nconst showLoader = () => loader.classList.add(\"visible\");\n\n// Приховати завантажувач\nconst hideLoader = () => loader.classList.remove(\"visible\");\n\n// Скидання пошуку\nconst resetSearch = () => {\n  pixabayApi.resetPage();\n  loadMoreBtn.classList.add(\"hidden\");\n  loader.classList.add(\"hidden\");\n  messageContainer.innerHTML = \"\"; // Прибираємо повідомлення\n  galleryContainer.innerHTML = \"\"; // Очищуємо галерею\n};\n\n// Обробка форми пошуку\nconst handleSearch = async (e) => {\n  e.preventDefault();\n\n  const searchQuery = e.target.elements.searchQuery.value.trim();\n  if (!searchQuery) return;\n\n  resetSearch();\n  pixabayApi.setQuery(searchQuery);\n\n  await fetchAndRenderImages();\n};\n\n// Завантаження та рендеринг зображень\nconst fetchAndRenderImages = async () => {\n  showLoader(); // Показуємо завантажувач\n\n  try {\n    const { hits, totalHits } = await pixabayApi.fetchImages();\n\n    if (hits.length === 0 && pixabayApi.page === 1) {\n      // Якщо перший запит не повернув жодного зображення\n      showMessage(\"No images found. Please try a different search query.\", messageContainer);\n      return;\n    }\n\n    const markup = renderImages(hits);\n    updateGallery(galleryContainer, markup, pixabayApi.page > 1);\n\n    lightbox.refresh();\n\n    // Якщо досягнуто кінця колекції\n    if (pixabayApi.page * pixabayApi.perPage >= totalHits) {\n      loadMoreBtn.classList.add(\"hidden\"); // Приховуємо кнопку\n      messageContainer.innerHTML = `\n        <p class=\"end-message\">We're sorry, but you've reached the end of search results.</p>\n      `; // Виводимо повідомлення\n    } else {\n      loadMoreBtn.classList.remove(\"hidden\"); // Показуємо кнопку \"Load More\"\n    }\n\n    // Прокрутка сторінки\n    if (pixabayApi.page > 1) {\n      const { height: cardHeight } = galleryContainer.firstElementChild.getBoundingClientRect();\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: \"smooth\",\n      });\n    }\n  } catch (error) {\n    console.error(\"Error fetching images:\", error);\n\n    // Якщо сталася помилка\n    messageContainer.innerHTML = `\n      <p class=\"error-message\">Something went wrong. Please try again later.</p>\n    `;\n  } finally {\n    hideLoader(); // Приховуємо завантажувач\n  }\n};\n\n// Обробка кнопки \"Load More\"\nconst handleLoadMore = async () => {\n  pixabayApi.incrementPage();\n  await fetchAndRenderImages();\n};\n\n// Слухачі подій\nsearchForm.addEventListener(\"submit\", handleSearch);\nloadMoreBtn.addEventListener(\"click\", handleLoadMore);\n"],"names":["API_KEY","BASE_URL","PixabayApi","axios","error","newQuery","renderImages","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","updateGallery","galleryContainer","markup","append","showMessage","message","container","searchForm","loadMoreBtn","messageContainer","loader","pixabayApi","lightbox","SimpleLightbox","showLoader","hideLoader","resetSearch","handleSearch","e","searchQuery","fetchAndRenderImages","hits","totalHits","cardHeight","handleLoadMore"],"mappings":"iyBAGA,MAAMA,EAAU,qCACVC,EAAW,2BAEF,MAAMC,CAAW,CAC9B,aAAc,CACZ,KAAK,MAAQ,GACb,KAAK,KAAO,EACZ,KAAK,QAAU,EAChB,CAED,MAAM,aAAc,CAClB,GAAI,CAYF,OAXiB,MAAMC,EAAM,IAAIF,EAAU,CACzC,OAAQ,CACN,IAAKD,EACL,EAAG,KAAK,MACR,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAM,KAAK,KACX,SAAU,KAAK,OAChB,CACT,CAAO,GACe,IACjB,OAAQI,EAAO,CACd,cAAQ,MAAM,yBAA0BA,CAAK,EACvCA,CACP,CACF,CAED,WAAY,CACV,KAAK,KAAO,CACb,CAED,eAAgB,CACd,KAAK,MAAQ,CACd,CAED,SAASC,EAAU,CACjB,KAAK,MAAQA,CACd,CACH,CCvCO,MAAMC,EAAgBC,GACpBA,EACJ,IACC,CAAC,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IAAO;AAAA,wCAC5CL,CAAa;AAAA,sBAC/BD,CAAY,UAAUE,CAAI;AAAA;AAAA,8CAEFC,CAAK;AAAA,8CACLC,CAAK;AAAA,iDACFC,CAAQ;AAAA,kDACPC,CAAS;AAAA;AAAA;AAAA,OAItD,EACA,KAAK,EAAE,EASCC,EAAgB,CAACC,EAAkBC,EAAQC,EAAS,KAAU,CACpEA,EAGHF,EAAiB,mBAAmB,YAAaC,CAAM,EAFvDD,EAAiB,UAAYC,CAIjC,EAOaE,EAAc,CAACC,EAASC,IAAc,CACjDA,EAAU,UAAY,sBAAsBD,CAAO,MACrD,ECvCME,EAAa,SAAS,cAAc,cAAc,EAClDN,EAAmB,SAAS,cAAc,UAAU,EACpDO,EAAc,SAAS,cAAc,YAAY,EACjDC,EAAmB,SAAS,cAAc,oBAAoB,EAC9DC,EAAS,SAAS,cAAc,SAAS,EAEzCC,EAAa,IAAIxB,EACjByB,EAAW,IAAIC,EAAe,YAAY,EAG1CC,EAAa,IAAMJ,EAAO,UAAU,IAAI,SAAS,EAGjDK,EAAa,IAAML,EAAO,UAAU,OAAO,SAAS,EAGpDM,EAAc,IAAM,CACxBL,EAAW,UAAS,EACpBH,EAAY,UAAU,IAAI,QAAQ,EAClCE,EAAO,UAAU,IAAI,QAAQ,EAC7BD,EAAiB,UAAY,GAC7BR,EAAiB,UAAY,EAC/B,EAGMgB,EAAe,MAAOC,GAAM,CAChCA,EAAE,eAAc,EAEhB,MAAMC,EAAcD,EAAE,OAAO,SAAS,YAAY,MAAM,OACnDC,IAELH,IACAL,EAAW,SAASQ,CAAW,EAE/B,MAAMC,EAAoB,EAC5B,EAGMA,EAAuB,SAAY,CACvCN,IAEA,GAAI,CACF,KAAM,CAAE,KAAAO,EAAM,UAAAC,CAAS,EAAK,MAAMX,EAAW,YAAW,EAExD,GAAIU,EAAK,SAAW,GAAKV,EAAW,OAAS,EAAG,CAE9CP,EAAY,wDAAyDK,CAAgB,EACrF,MACD,CAED,MAAMP,EAASX,EAAa8B,CAAI,EAgBhC,GAfArB,EAAcC,EAAkBC,EAAQS,EAAW,KAAO,CAAC,EAE3DC,EAAS,QAAO,EAGZD,EAAW,KAAOA,EAAW,SAAWW,GAC1Cd,EAAY,UAAU,IAAI,QAAQ,EAClCC,EAAiB,UAAY;AAAA;AAAA,SAI7BD,EAAY,UAAU,OAAO,QAAQ,EAInCG,EAAW,KAAO,EAAG,CACvB,KAAM,CAAE,OAAQY,CAAU,EAAKtB,EAAiB,kBAAkB,wBAClE,OAAO,SAAS,CACd,IAAKsB,EAAa,EAClB,SAAU,QAClB,CAAO,CACF,CACF,OAAQlC,EAAO,CACd,QAAQ,MAAM,yBAA0BA,CAAK,EAG7CoB,EAAiB,UAAY;AAAA;AAAA,KAGjC,QAAY,CACRM,GACD,CACH,EAGMS,EAAiB,SAAY,CACjCb,EAAW,cAAa,EACxB,MAAMS,EAAoB,CAC5B,EAGAb,EAAW,iBAAiB,SAAUU,CAAY,EAClDT,EAAY,iBAAiB,QAASgB,CAAc"}